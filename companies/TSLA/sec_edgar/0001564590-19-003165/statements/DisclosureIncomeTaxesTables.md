## DisclosureIncomeTaxesTables

**Year Ended**

|  | Dec 31, 2018 | Dec 31, 2017 | Dec 31, 2016 |
| --- | --- | --- | --- |
| **  Schedule of Loss before Provision For Income Taxes** | Year Ended December 31,                                                         
                                              2018                              
2017                     2016               
 ───────────────────────────────────────────────────────────────────────────────
───────────────────────────────────────────────────────
  Domestic                                    $                              
412,133      $           993,113      $         130,718  
  Noncontrolling interest and redeemable                                      
86,491                  279,178                 98,132  
  Foreign                                                                    
506,121                  936,741                517,498  
  Loss before income taxes                    $                            
1,004,745      $         2,209,032      $         746,348
 |  |  |
| **  Components of Provision for Income Taxes** | The components of the provision for income taxes for the years ended December 
31, 2018, 2017 and 2016 consisted of the following (in thousands):

                                        Year Ended December 31,                 
                                        2018                                    
2017                  2016               
 ───────────────────────────────────────────────────────────────────────────────
───────────────────────────────────────────
  Current:                                                                      
  Federal                               $                              (901     
$         (9,552      $         —        
  State                                                               2,792     
2,029                568      
  Foreign                                                            23,622     
42,715                53,962   
  Total current                                                      25,513     
35,192                54,530   
  Deferred:                                                                     
  Federal                                                                 —     
—                —        
  State                                                                   —     
—                —        
  Foreign                                                            32,324     
(3,646                (27,832  
  Total deferred                                                     32,324     
(3,646                (27,832  
  Total provision for income taxes      $                            57,837     
$         31,546      $         26,698
 |  |  |
| **  Schedule of Deferred Tax Assets (Liabilities)** | Deferred tax assets (liabilities) as of December 31, 2018 and 2017 consisted of 
the following (in thousands):

                                                            December 31,      
December 31,  
                                                                    2018        
2017  
 ───────────────────────────────────────────────────────────────────────────────
─────────────
  Deferred tax assets:                                                          
  Net operating loss carry-forwards                           $1,759,716        
$1,575,952  
  Research and development credits                               376,556        
306,808  
  Other tax credits                                              127,813        
117,997  
  Deferred revenue                                               155,757        
200,531  
  Inventory and warranty reserves                                165,262        
74,578  
  Stock-based compensation                                       102,256        
96,916  
  Investment in certain financing funds                                —        
24,471  
  Accruals and others                                             28,295        
26,416  
  Total deferred tax assets                                    2,715,655        
2,423,669  
  Valuation allowance                                         (1,805,648        
(1,843,713  
  Deferred tax assets, net of valuation allowance                910,007        
579,956  
  Deferred tax liabilities:                                                     
  Depreciation and amortization                                 (860,611        
(537,613  
  Other                                                          (23,850        
(18,734  
  Investment in certain financing funds                          (33,493        
—  
  Total deferred tax liabilities                                (917,954        
(556,347  
  Deferred tax liabilities, net of valuation allowance           $(7,947        
$23,609
 |  |  |
| **  Schedule of Reconciliation of Taxes at Federal Statutory Rate to Provision for Income Taxes** | The reconciliation of taxes at the federal statutory rate to our provision for 
income taxes for the years ended December 31, 2018, 2017 and 2016 was as follows
(in thousands):

                                                  Year Ended December 31,       
                                                                     2018       
2017           2016  
  Tax at statutory federal rate                                 $(210,996       
$(773,162      $(261,222  
 ───────────────────────────────────────────────────────────────────────────────
───────────────────────────
  State tax, net of federal benefit                                 2,792       
2,029            568  
  Nondeductible expenses                                           65,375       
30,138         26,547  
  Excess tax benefits related to stock based                      (43,977      
(1,013,196              —  
  Foreign income rate differential                                160,370       
364,699        206,470  
  U. S. tax credits                                               (79,565       
(109,501       (162,865  
  Noncontrolling interests and redeemable                          31,858       
65,920         21,964  
  Effect of U. S. tax law change (2)                                    —       
722,646              —  
  Bargain in purchase gain                                              —       
20,211        (31,055  
  Other reconciling items                                             960       
3,178            785  
  Change in valuation allowance                                   131,020       
718,584        225,506  
  Provision for income taxes                                      $57,837       
$31,546        $26,698
 |  |  |
| **  Schedule of Changes to Gross Unrecognized Tax Benefits** | The changes to our gross unrecognized tax benefits were as follows (in 
thousands):

  December 31, 2015                                               99,127  
  Increases in balances related to prior year tax positions       28,677  
  Increases in balances related to current year tax               62,805  
  Assumed uncertain tax positions through acquisition             13,327  
  December 31, 2016                                              203,936  
  Decrease in balances related to prior year tax positions       (31,493  
  Increases in balances related to current year tax               84,352  
  Change in balances related to effect of U. S. tax law          (58,050  
  December 31, 2017                                              198,745  
  Decrease in balances related to prior year tax positions        (6,347  
  Increases in balances related to current year tax               60,960  
  December 31, 2018                                              253,357
 |  |  |